(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1066:function(e,t,r){"use strict";var n=r(41),a=r(208),o=r(125),s=r(874),i=r(4),d=r.n(i),l=(r(6),r(0)),c=r.n(l),u=r(19),p=r(9),f=r(1077),_=r.n(f),m=r(84);var y=r(912),A=r(13),h=r(24),v=r.n(h),D=r(34),g=r(60),S=r(65),E=r(45),R=r(29);let b=Object(p.a)("widgets/addressDropdown");const O=u.h.div({margin:"1rem 2rem",[R.f]:{margin:"1rem 0"}}),L=A.a.create({dropDownContainer:{margin:"10px 0 0",position:"relative"},dropDown:{padding:"0 1.5rem 0 0",textIndent:10,WebkitAppearance:"none",MozAppearance:"none",appearance:"none","@-moz-document url-prefix()":{textIndent:2.5},"::-ms-expand":{display:"none"}},arrow:{position:"absolute",top:"50%",cursor:"pointer",pointerEvents:"none"}});class T extends c.a.Component{constructor(){super(...arguments),d()(this,"renderDropdownOptions",()=>this.props.addresses.map(e=>{const t=this.convertAddressToSingleLine(e);return Object(g.a)()?t?{value:e.id,primaryText:t}:void 0:t?c.a.createElement("option",{key:e.id,id:e.id,value:e.id},t):null}).filter(e=>void 0!==e)),d()(this,"convertAddressToSingleLine",e=>{const t=b("label.ellipsis"),r=function(e){const t=Object(m.a)(),r=_.a.createHandler(t);try{const t=r.formatAddress(e,{style:r.ADDRESS_FORMAT_DISPLAY_SINGLE});if("string"==typeof t)return t;throw t}catch(e){return window.onerror("griffin::formatAddressToSingleLine","",0,0,e),""}}({address_line_1:e.addressLine1&&e.addressLine1.value||e.address_line_1,address_line_2:e.addressLine2&&e.addressLine2.value||e.address_line_2,admin_area_2:e.city&&e.city.value||e.admin_area_2,admin_area_1:e.state&&e.state.value||e.admin_area_1,postal_code:e.zipcode&&e.zipcode.value||e.postal_code,country_code:e.countryCode||e.country_code});return r.length>75?r.substring(0,75)+t:r}),d()(this,"handleChange",e=>{if("handleAddAddress"===e.target.value)return this.props.handleAddAddress();this.props.handleSelectAddress(e.target.value)}),d()(this,"handleClick",()=>{this.props.handleAddAddress(),Object(S.a)(E.b.p2p_review_shipping_address_pressed())})}componentWillReceiveProps(e){e.shakeBillingLabel&&!this.props.shakeBillingLabel&&setTimeout(()=>{this.props.dispatch(y.f(e.shakeBillingLabel))},2e3)}render(){const{yourAddressContentKey:e,selectElementId:t,shouldRenderLabel:r,addresses:i,selectedAddress:d,hasNoAddressNeededOption:l,addNewAddressContentKey:p,dir:f,shakeBillingLabel:_,showENSubTextRTR:m}=this.props;return Object(g.a)()?c.a.createElement(O,null,i.length>0&&c.a.createElement(s.a,{id:t,label:c.a.createElement(c.a.Fragment,null,b(e),m&&"(".concat(D.a[e],")")),options:[...l?[{value:"",primaryText:b("label.noAddressNeeded")}]:[],...this.renderDropdownOptions(),{value:"handleAddAddress",primaryText:b(p)}],"data-nemo":"add-shipping-address",value:d.id,onChange:this.handleChange,onClick:()=>Object(S.a)(E.b.p2p_review_shipping_address_pressed())}),0===i.length&&c.a.createElement(c.a.Fragment,null,c.a.createElement(o.a,{tertiary:!0,type:"button",style:{padding:0},"data-nemo":"add-fi-btn",onClick:this.handleClick},b(p)),m&&c.a.createElement(n.e,{style:{color:a.fb}},D.a[p]))):c.a.createElement(u.h.Div,{margin:"1em auto",maxWidth:"398px"},r&&i.length>0&&c.a.createElement(c.a.Fragment,null,c.a.createElement(u.h.Label,{htmlFor:t,className:"vx_text-5",textAlign:"left",marginBottom:m?"0":"1em",fontWeight:"500",display:"block"},b(e)),m&&c.a.createElement(u.h.Label,{htmlFor:t,className:"vx_text-5",textAlign:"left",marginBottom:"1em",fontWeight:"400",fontSize:"14px",color:"#687173",display:"block"},D.a[e])),i.length>0&&c.a.createElement("div",{className:Object(A.b)(L.dropDownContainer)},c.a.createElement("select",{id:t,className:v()("vx_form-control",Object(A.b)(L.dropDown)),"data-nemo":"add-shipping-address",value:d.id,onChange:this.handleChange,"aria-label":r?"":b(e)},l&&c.a.createElement("option",{value:""},b("label.noAddressNeeded")),this.renderDropdownOptions(),c.a.createElement("option",{value:"handleAddAddress"},b(p))),c.a.createElement("label",{htmlFor:t,style:"rtl"===f?{left:10}:{right:10},className:"icon icon-arrow-down-small ".concat(Object(A.b)(Object(A.c)(L.arrow)))})),0===i.length&&c.a.createElement(c.a.Fragment,null,c.a.createElement(u.h.Label,{className:_&&"animated shake",onClick:this.handleClick,fontWeight:"500",color:"#0070ba",cursor:"pointer"},b(p)),m&&c.a.createElement(u.h.Label,{fontWeight:"500",fontSize:"14px",color:"#687173"},D.a[p])))}}t.a=T},1077:function(e,t,r){"use strict";e.exports=r(1078)},1078:function(e,t,r){"use strict";var n=r(1079),a=r(173),o=a.assertMetadata,s=a.assertType,i=r(147),d=i.definePrivateProperty,l=i.formatMessage,c=/Unsupported value for address.country_code/;function u(){}function p(e,t){return e.countryAliasMapping[t]||t||e.country}function f(e){if(c.test(e.message))throw new Error(l("You have not loaded metadata for `{{country}}` country",{country:e.attributes.countryCode}));throw e}n.setConstants(u),Object.defineProperty(u.prototype,"formatAddress",{value:function(e,t){var r=this.metadata;try{return n.formatAddress(e,t,r,{getCountry:p.bind(null,r),handlerDefaultScript:r.script})}catch(e){f(e)}},enumerable:!0}),Object.defineProperty(u.prototype,"validateAddress",{value:function(e,t){var r=this.metadata;try{return n.validateAddress(e,t,r,{handlerDefaultScript:r.script,getCountry:p.bind(null,r)})}catch(e){f(e)}},enumerable:!0}),Object.defineProperty(u.prototype,"transformAddress",{value:function(e,t){var r=this.metadata;try{return n.transformAddress(e,t,r,{getCountry:p.bind(null,r)})}catch(e){f(e)}},enumerable:!0}),e.exports={createHandler:function(e){s(e,"metadata",["plain object"]),o(e.griffin),o(e.griffin.address),e=e.griffin.address,o(e.country,["string"]),o(e.language,["string"]),o(e.script,["string"]),o(e.territory);var t=new u;return d(t,"metadata",e),t}}},1079:function(e,t,r){"use strict";var n=r(173),a=n.assertRange,o=n.assertType,s=r(147),i=s.defineProperties,d=s.getValueOrDefault,l=s.isLatin,c=s.jsonDeepMerge,u=s.objectGet,p=s.objectValues,f=s.trimObject,_=r(121),m={ADDRESS_FORMAT_INPUT:"input",ADDRESS_FORMAT_DISPLAY_SINGLE:"single_line",ADDRESS_FORMAT_DISPLAY_MULTI:"multi_line"},y={ADDRESS_COARSE:"coarse",ADDRESS_PORTABLE:"portable",ADDRESS_PORTABLE_WITH_DETAILS:"detailed"},A={coarse:[y.ADDRESS_PORTABLE],portable:[y.ADDRESS_COARSE],detailed:[y.ADDRESS_PORTABLE]},h=p(m),v=[y.ADDRESS_COARSE,y.ADDRESS_PORTABLE],D=p(y),g=["line1","line2","state","city","postal_code","country_code"],S={DISPLAY:g},E=["address_line_1","address_line_2","address_line_3"],R=E.concat(["admin_area_4","admin_area_3","admin_area_2","admin_area_1","postal_code","country_code"]),b=R.concat(["address_details.building_name","address_details.delivery_service","address_details.street_name","address_details.street_number","address_details.street_type","address_details.sub_building"]),O={DISPLAY:["full_name","business_name"].concat(R)},L={coarse:g,portable:R,detailed:b},T=[{name:"ADDRESS_REQUIRED_FIELD_MISSING",message:"A required address field is missing",detail:"address_details"}];function I(e){var t,r=e.address,n=e.handlerDefaultScript,a=e.metadata,o=e.style||m.ADDRESS_FORMAT_INPUT,s=e.type;return t=o===m.ADDRESS_FORMAT_INPUT?u(a,["territory",r.country_code,"script",n])?n:"Latn":function(e){var t=e.address,r=e.metadata,n=e.type;if(function(e,t){var r="portable"===t?O.DISPLAY:S.DISPLAY;return(r=r.filter((function(e){return"postal_code"!==e}))).every((function(t){return l(e[t])}))}(t,n))return"Latn";return u(r,["territory",t.country_code,"primary_script"])}({address:r,metadata:a,type:s}),u(a,["territory",r.country_code,"script",t,"layout_type",s+"_"+o])||{}}function w(e,t,r,n){return u(e,["territory",t,"transform_mapping",r+"_to_"+n])}function C(e){o(e,"address",["plain object"]);var t=Object.keys(e);e.address_details&&(t=t.concat(Object.keys(e.address_details).map((function(e){return"address_details."+e})))),t.forEach((function(t){var r=u(e,t.split("."));o(r,"address."+t,"address_details"!==t?["undefined","null","string"]:["plain object"])}))}function P(e,t,r){return e=(0,r.getCountry)(e),a(e,t.territory,"Unsupported value for address.country_code: {countryCode}",{countryCode:e}),e}function x(e){var t=d(e,y.ADDRESS_PORTABLE);return o(t,"options.type",["string"]),a(t,v,"Invalid value for options.type: {type}",{type:t}),t}function j(e){if(e)return e.replace(/^{(.*?)}$/,"$1")}function N(e){var t=e.address,r=e.detailedLayout,n=e.layout,a=e.metadata,o=e.properties,s=e.type,i=u(a,["territory",t.country_code,"strings"]);i=i[Object.keys(i)[0]];var d=u(i,["address_"+s,"labels"]),l=u(i,"preset_values");return i=u(i,"address_"+s),c({layout:n,properties:Object.keys(o).reduce((function(e,r){var n,a=o[r]||{},s=u(i,["preset_values",r,"list"]),c=u(i,["preset_values",r,"group_list"]);return e[r]={casing:a&&a.casing,maxLength:a&&a.max_length,required:a&&a.required,hidden:a&&a.hidden,label:d[r],value:a.preset_data||u(t,r.split("."))||"",list:l[j(s)],groupList:l[j(c)]},n=e[r],Object.keys(n).forEach((function(e){void 0===n[e]&&delete n[e]})),e}),{})},r&&{detailedLayout:r})}function k(e,t){e.forEach((function(e){e.forEach((function(e){if("separator"===e.type)return e;var r=t[e.type]||{};e.value=function(e,t){if(void 0!==t.preset_data)return t.preset_data;var r=t.prefix||"",n=t.postfix||"",a=t.casing;return r+function(e,t){if("uppercase"===t)return e.toUpperCase();if("lowercase"===t)return e.toLowerCase();return e}(e||"",a)+n||""}(e.value,r)}))}))}function F(e,t,r){return r.map((function(r){return-1===t.indexOf(r)?{type:"separator",value:r}:{type:r,value:u(e,r.split("."))}}))}function M(e){return e.filter((function(e){return e.value})).filter((function(e,t,r){return"separator"!==e.type||(!r[t+1]||"separator"!==r[t+1].type)})).filter((function(e,t,r){return"separator"!==e.type||0!==t&&t!==r.length-1})).reduce((function(e,t){return e+t.value}),"")}function B(e,t){var r=t===y.ADDRESS_PORTABLE?R.concat("address_details"):g;return f(e,r)}function U(e){var t={};return void 0!==e.postcode&&void 0===e.postal_code&&(t.postal_code=e.postcode),void 0!==e.country&&void 0===e.country_code&&(t.country_code=e.country),Object.keys(t).length&&(e=c(e,t)),e}function Y(e,t){var r=t.address_lines.map((function(t){return M(F(e,b,t))})).filter((function(e){return""!==e})).reduce((function(e,t,r){return e["address_line_"+(r+1)]=t,e}),{}),n=_({},t);delete n.address_lines;var a=z({fromAddress:e,fromAddressFields:b,patternsData:{},transformMapping:n});return c(r,a)}function z(e){var t=e.fromAddress,r=e.fromAddressFields,n=e.patternsData,a=e.transformMapping,o={},s={},i=function(e,t){return t.replace(/^patterns\.(.*?)\.\$([0-9])$/,(function(t,r,a){return o[e]=new RegExp("^"+n[r]+"$"),s[e]=+a,r}))};return Object.keys(a).map((function(e){var n=a[e];return n=n.map(i.bind(null,e)),{toField:e,value:M(F(t,r,n))}})).filter((function(e){return""!==e.value})).reduce((function(e,t){var r,n=t.toField,a=t.value;return o[n]&&(r=a.match(o[n]),a=r[s[n]]),a&&(e[n]=a),e}),{})}function W(e,t,r){return t.reduce((function(t,n){return t.concat(function(e,t,r){if(!r[t])return[];var n,a=[],o=u(e,t.split("."));return r[t].required&&!o&&a.push({name:"ADDRESS_REQUIRED_FIELD_MISSING",message:"A required address field is missing",detail:t}),"postal_code"===t&&r[t].validation_regex&&(n=new RegExp("^"+r[t].validation_regex+"$"),o&&!n.test(o)&&a.push({name:"ADDRESS_PATTERN_VALIDATION_ERROR",message:"The field provided does not match the validation pattern",detail:{field:t}})),a}(e,n,r))}),[])}e.exports={formatAddress:function(e,t,r,n){C(e),t=d(t,{}),o(t,"options",["plain object"]);var s=d(t.style,m.ADDRESS_FORMAT_DISPLAY_MULTI);o(s,"options.style",["string"]),a(s,h,"Invalid value for options.style: {style}",{style:s});var i=x(t.type),l=d(t.showCountryName,!1);o(l,"options.showCountryName",["boolean"]),o(t.name,"options.name",["string","undefined"]),o(t.organization,"options.organization",["string","undefined"]),i===y.ADDRESS_COARSE&&(e=U(e)),e=B(e,i);try{e.country_code=P(e.country_code,r,n)}catch(t){return{errors:[{name:"ADDRESS_INVALID_COUNTRY_ERROR",message:"Unsupported country/region: "+e.country_code+" or was not loaded on the client metadata",detail:{field:"country_code"}}]}}var c=I({address:e,handlerDefaultScript:n.handlerDefaultScript,metadata:r,style:s,type:i}),u=c.properties,p=c.layout,f=c.detailedLayout;if(s===m.ADDRESS_FORMAT_INPUT)return N({address:e,detailedLayout:f,layout:p,metadata:r,properties:u,type:i});i===y.ADDRESS_PORTABLE&&e.address_details&&(e=Y(e,w(r,e.country_code,"detailed","portable"))),e.full_name=t.name,e.business_name=t.organization;var _=function(e,t,r){var n=r===y.ADDRESS_COARSE?S.DISPLAY:O.DISPLAY;return t.map(F.bind(null,e,n))}(e,f||p,i);l||(_=_.map((function(e){return e.filter((function(e){return"country_code"!==e.type}))}))),k(_,u);var A=function(e){return e.map((function(e){return M(e)})).filter((function(e){return""!==e}))}(_);return s===m.ADDRESS_FORMAT_DISPLAY_SINGLE?A.join(""):A},setConstants:function(e){i(e,m),i(e,y)},transformAddress:function(e,t,r,n){C(e),t=d(t,{}),o(t,"options",["plain object"]);var s=t.fromType;o(s,"options.fromType",["string"]),a(s,D,"Invalid value for options.fromType: {type}",{type:s});var i=L[s],l=t.toType;o(l,"options.toType",["string"]),a(l,D,"Invalid value for options.toType: {type}",{type:l}),s===y.ADDRESS_COARSE&&(e=U(e));try{var c=P(e.country_code,r,n)}catch(t){return{errors:[{name:"ADDRESS_INVALID_COUNTRY_ERROR",message:"Unsupported country/region: "+e.country_code+" or was not loaded on the client metadata",detail:{field:"country_code"}}]}}if(s===l)return e;if(a(l,A[s],"Address transformation is not allowed options.fromType: {fromType} to options.toType: {toType}",{fromType:s,toType:l}),s===y.ADDRESS_PORTABLE_WITH_DETAILS&&l===y.ADDRESS_PORTABLE)return Y(e,w(r,c,"detailed","portable"));var p=w(r,c,s,l),f=!e.address_details||!Object.keys(e.address_details).length;return s!==y.ADDRESS_PORTABLE||f||(e=Y(e,w(r,c,"detailed","portable"))),z({fromAddress:e,fromAddressFields:i,patternsData:u(r,["territory",c,"transform_mapping","transform_properties","patterns"]),transformMapping:p})},validateAddress:function(e,t,r,n){C(e),t=d(t,{}),o(t,"options",["plain object"]);var s=x(t.type),i=s===y.ADDRESS_PORTABLE?b:L[s],l=t.field;o(l,"options.field",["undefined","string"]),l&&(a(l,i,"Invalid value for options.field: {field}",{field:l}),i=[l]),s===y.ADDRESS_COARSE&&(e=U(e)),e=B(e,s);try{e.country_code=P(e.country_code,r,n)}catch(t){return{errors:[{name:"ADDRESS_INVALID_COUNTRY_ERROR",message:"Unsupported country/region: "+e.country_code+" or was not loaded on the client metadata",detail:{field:"country_code"}}]}}var c=I({address:e,handlerDefaultScript:n.handlerDefaultScript,metadata:r,type:s}),u=c.properties,p=c.detailedLayout;if(s===y.ADDRESS_PORTABLE&&p&&!l){var f=W(e,R,u),_=W(e,p.reduce((function(e,t){return t.forEach((function(t){-1!==b.indexOf(t)&&e.push(t)})),e}),[]),u);if(f.length&&_.length)return{errors:f.concat(_.filter((function(e){return/address_details/.test(e.detail)})))};if(f.length){var m=f.filter((function(e){return"ADDRESS_REQUIRED_FIELD_MISSING"===e.name&&E.includes(e.detail)}));if(m){var A=[];if(e.address_details){var h=e.address_details;Object.keys(h).forEach((function(e){h[e]&&""!==h[e]&&A.push(h[e])}))}if(!A.length)return{errors:T.concat(m)}}}return{}}var v=W(e,i,u);return v.length?{errors:v}:{}}}}}]);
//# sourceMappingURL=48.esm.js.map